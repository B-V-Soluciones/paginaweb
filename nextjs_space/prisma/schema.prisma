generator client {
    provider = "prisma-client-js"
    binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
    output = "/home/ubuntu/gestion_inventario/nextjs_space/node_modules/.prisma/client"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Category {
  id        String    @id @default(cuid())
  name      String
  color     String    @default("#3B82F6")
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  products  Product[]
}

model Product {
  id                String          @id @default(cuid())
  name              String
  sku               String          @unique
  categoryId        String?
  category          Category?       @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  price             Float
  stock             Int             @default(0)
  minStock          Int             @default(10)
  imageUrl          String?
  cloudStoragePath  String?
  isPublic          Boolean         @default(true)
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt
  stockMovements    StockMovement[]

  @@index([categoryId])
  @@index([sku])
}

model StockMovement {
  id          String   @id @default(cuid())
  productId   String
  product     Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  type        String   // "entrada" o "salida"
  quantity    Int
  reason      String
  date        DateTime @default(now())
  createdAt   DateTime @default(now())

  @@index([productId])
  @@index([date])
}
